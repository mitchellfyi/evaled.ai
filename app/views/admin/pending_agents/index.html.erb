<div class="page-header" style="display: flex; justify-content: space-between; align-items: center;">
  <h1>Pending Agents</h1>
  <span class="badge badge-active"><%= PendingAgent.pending.count %> awaiting review</span>
</div>

<style>
  .filters {
    display: flex;
    gap: 1rem;
    margin-bottom: 1.5rem;
  }

  .filters a {
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    text-decoration: none;
    font-size: 0.875rem;
    font-weight: 500;
    background: white;
    color: #374151;
    border: 1px solid #e5e7eb;
  }

  .filters a.active {
    background: #4f46e5;
    color: white;
    border-color: #4f46e5;
  }

  .data-table {
    width: 100%;
    background: white;
    border-radius: 0.75rem;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    overflow: hidden;
  }

  .data-table th,
  .data-table td {
    padding: 1rem;
    text-align: left;
    border-bottom: 1px solid #e5e7eb;
  }

  .data-table th {
    background: #f9fafb;
    font-weight: 600;
    font-size: 0.875rem;
    color: #374151;
  }

  .data-table tr:last-child td {
    border-bottom: none;
  }

  .badge {
    display: inline-block;
    padding: 0.25rem 0.5rem;
    border-radius: 9999px;
    font-size: 0.75rem;
    font-weight: 500;
  }

  .badge-active {
    background: #d1fae5;
    color: #065f46;
  }

  .badge-pending {
    background: #fef3c7;
    color: #92400e;
  }

  .badge-approved {
    background: #d1fae5;
    color: #065f46;
  }

  .badge-rejected {
    background: #fee2e2;
    color: #991b1b;
  }

  .score-high {
    color: #065f46;
    font-weight: 700;
  }

  .score-medium {
    color: #92400e;
    font-weight: 700;
  }

  .btn {
    display: inline-block;
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    text-decoration: none;
    font-size: 0.875rem;
    font-weight: 500;
    cursor: pointer;
    border: none;
  }

  .btn-sm {
    padding: 0.25rem 0.5rem;
    font-size: 0.75rem;
  }

  .btn-success {
    background: #059669;
    color: white;
  }

  .btn-danger {
    background: #dc2626;
    color: white;
  }

  .btn-primary {
    background: #4f46e5;
    color: white;
  }

  .actions-cell {
    display: flex;
    gap: 0.5rem;
    align-items: center;
  }
</style>

<div class="filters">
  <%= link_to "All", admin_pending_agents_path, class: params[:status].blank? ? "active" : "" %>
  <%= link_to "Pending", admin_pending_agents_path(status: "pending"), class: params[:status] == "pending" ? "active" : "" %>
  <%= link_to "Approved", admin_pending_agents_path(status: "approved"), class: params[:status] == "approved" ? "active" : "" %>
  <%= link_to "Rejected", admin_pending_agents_path(status: "rejected"), class: params[:status] == "rejected" ? "active" : "" %>
</div>

<table class="data-table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Owner</th>
      <th>Stars</th>
      <th>Language</th>
      <th>Score</th>
      <th>Status</th>
      <th>Discovered</th>
      <th>Actions</th>
    </tr>
  </thead>
  <tbody>
    <% if @pending_agents.any? %>
      <% @pending_agents.each do |pa| %>
        <tr>
          <td>
            <%= link_to pa.name, pa.github_url, target: "_blank", rel: "noopener" %>
          </td>
          <td><%= pa.owner %></td>
          <td><%= number_with_delimiter(pa.stars || 0) %></td>
          <td><%= pa.language %></td>
          <td>
            <span class="<%= pa.confidence_score && pa.confidence_score >= 80 ? 'score-high' : 'score-medium' %>">
              <%= pa.confidence_score %>
            </span>
          </td>
          <td>
            <span class="badge badge-<%= pa.status %>"><%= pa.status.capitalize %></span>
          </td>
          <td><%= pa.discovered_at&.strftime("%Y-%m-%d") %></td>
          <td class="actions-cell">
            <%= link_to "View", admin_pending_agent_path(pa), class: "btn btn-sm btn-primary" %>
            <% if pa.pending? %>
              <%= button_to "Approve", approve_admin_pending_agent_path(pa), method: :post, class: "btn btn-sm btn-success" %>
              <%= button_to "Reject", reject_admin_pending_agent_path(pa), method: :post, class: "btn btn-sm btn-danger" %>
            <% end %>
          </td>
        </tr>
      <% end %>
    <% else %>
      <tr>
        <td colspan="8" style="text-align: center; color: #6b7280; padding: 2rem;">
          No pending agents found.
        </td>
      </tr>
    <% end %>
  </tbody>
</table>
